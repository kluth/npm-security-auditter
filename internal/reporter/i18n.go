package reporter

import (
	"fmt"

	"github.com/kluth/npm-security-auditter/internal/analyzer"
)

type Language string

const (
	LangEN  Language = "en"
	LangDE  Language = "de"
	LangFR  Language = "fr"
	LangES  Language = "es"
	LangIT  Language = "it"
	LangPT  Language = "pt"
	LangJP  Language = "jp"
	LangZH  Language = "zh"
	LangRU  Language = "ru"
	LangTLH Language = "tlh" // Klingon
	LangVUL Language = "vul" // Vulcan
	LangSIN Language = "sin" // Sindarin
)

var translations = map[Language]map[string]string{
	LangEN: {
		"title":              "npm Security Audit Report",
		"pkg_info":           "Package Information",
		"package":            "Package",
		"license":            "License",
		"maintainers":        "Maintainers",
		"repository":         "Repository",
		"created":            "Created",
		"versions":           "Versions",
		"published":          "published",
		"dependencies":       "Dependencies",
		"direct":             "direct",
		"install_scripts":    "Install Scripts",
		"scripts_yes":        "YES — runs code on install",
		"scripts_none":       "None",
		"risk_assessment":    "Risk Assessment",
		"critical_risk":      "CRITICAL RISK",
		"moderate_risk":      "MODERATE RISK",
		"elevated_risk":      "ELEVATED RISK",
		"low_risk":           "LOW RISK",
		"score_label":        "Score: %d / 100",
		"analyzer_errors":    "Analyzer Errors",
		"no_issues":          "No issues found. Package appears safe.",
		"findings_summary":   "Findings Summary",
		"total_findings":     "Total: %d findings across %d analyzers",
		"severity_critical":  "CRITICAL",
		"severity_high":      "HIGH",
		"severity_medium":    "MEDIUM",
		"severity_low":       "LOW",
		"finding_plural":     "finding",
		"findings_plural":    "findings",
		"findings_count":     "%s Findings (%d)",
		"analyzer_label":     "Analyzer: %s",
		"attack_scenario":    "Attack Scenario:",
		"remediation":        "Remediation Advice:",
		"analyzer_breakdown": "Per-Analyzer Breakdown",
		"clean":              "clean",
		"recommendations":    "Recommendations",
		"rec_critical":       "DO NOT install this package without thorough manual review",
		"rec_moderate":       "Review all HIGH and CRITICAL findings before installing",
		"rec_scripts":        "Install with --ignore-scripts and inspect scripts manually",
		"rec_typosquat":      "Verify you have the correct package name — this looks like a typosquat",
		"rec_vuln":           "Check if vulnerabilities are fixed in a newer version",
		"rec_provenance":     "Prefer packages with build provenance",
		"rec_deps":           "Audit the full dependency tree",
		"rec_maintainer":     "Verify maintainer identity and check for recent ownership transfers",
		"rec_safe":           "No major concerns — package appears safe for use",
		"audited_at":         "Audited at %s",
	},
	LangDE: {
		"title":              "npm Sicherheits-Audit Bericht",
		"pkg_info":           "Paket-Informationen",
		"package":            "Paket",
		"license":            "Lizenz",
		"maintainers":        "Maintainer",
		"repository":         "Repository",
		"created":            "Erstellt",
		"versions":           "Versionen",
		"published":          "veröffentlicht",
		"dependencies":       "Abhängigkeiten",
		"direct":             "direkt",
		"install_scripts":    "Installations-Skripte",
		"scripts_yes":        "JA — führt Code bei Installation aus",
		"scripts_none":       "Keine",
		"risk_assessment":    "Risikobewertung",
		"critical_risk":      "KRITISCHES RISIKO",
		"moderate_risk":      "MODERATES RISIKO",
		"elevated_risk":      "ERHÖHTES RISIKO",
		"low_risk":           "GERINGES RISIKO",
		"score_label":        "Score: %d / 100",
		"analyzer_errors":    "Analyse-Fehler",
		"no_issues":          "Keine Probleme gefunden. Paket scheint sicher zu sein.",
		"findings_summary":   "Zusammenfassung der Befunde",
		"total_findings":     "Gesamt: %d Befunde von %d Analysatoren",
		"severity_critical":  "KRITISCH",
		"severity_high":      "HOCH",
		"severity_medium":    "MITTEL",
		"severity_low":       "NIEDRIG",
		"finding_plural":     "Befund",
		"findings_plural":    "Befunde",
		"findings_count":     "%s Befunde (%d)",
		"analyzer_label":     "Analysator: %s",
		"attack_scenario":    "Angriffsszenario:",
		"remediation":        "Behebung:",
		"analyzer_breakdown": "Aufschlüsselung pro Analysator",
		"clean":              "sauber",
		"recommendations":    "Empfehlungen",
		"rec_critical":       "Installieren Sie dieses Paket NICHT ohne gründliche manuelle Prüfung",
		"rec_moderate":       "Überprüfen Sie alle HOCH- und KRITISCH-Befunde vor der Installation",
		"rec_scripts":        "Mit --ignore-scripts installieren und Skripte manuell prüfen",
		"rec_typosquat":      "Überprüfen Sie den Paketnamen — dies sieht nach Typosquatting aus",
		"rec_vuln":           "Prüfen Sie, ob Schwachstellen in einer neueren Version behoben sind",
		"rec_provenance":     "Bevorzugen Sie Pakete mit Herkunftsnachweis (provenance)",
		"rec_deps":           "Prüfen Sie den vollständigen Abhängigkeitsbaum",
		"rec_maintainer":     "Identität der Maintainer prüfen und auf Besitzerwechsel achten",
		"rec_safe":           "Keine größeren Bedenken — Paket scheint sicher zu sein",
		"audited_at":         "Geprüft am %s",
	},
	LangFR: {
		"title":              "Rapport d'Audit de Sécurité npm",
		"pkg_info":           "Informations sur le Paquet",
		"package":            "Paquet",
		"license":            "Licence",
		"maintainers":        "Mainteneurs",
		"repository":         "Dépôt",
		"created":            "Créé",
		"versions":           "Versions",
		"published":          "publié",
		"dependencies":       "Dépendances",
		"direct":             "direct",
		"install_scripts":    "Scripts d'Installation",
		"scripts_yes":        "OUI — exécute du code à l'installation",
		"scripts_none":       "Aucun",
		"risk_assessment":    "Évaluation des Risques",
		"critical_risk":      "RISQUE CRITIQUE",
		"moderate_risk":      "RISQUE MODÉRÉ",
		"elevated_risk":      "RISQUE ÉLEVÉ",
		"low_risk":           "RISQUE FAIBLE",
		"score_label":        "Score: %d / 100",
		"analyzer_errors":    "Erreurs d'Analyse",
		"no_issues":          "Aucun problème trouvé. Le paquet semble sûr.",
		"findings_summary":   "Résumé des Résultats",
		"total_findings":     "Total: %d résultats via %d analyseurs",
		"severity_critical":  "CRITIQUE",
		"severity_high":      "HAUT",
		"severity_medium":    "MOYEN",
		"severity_low":       "FAIBLE",
		"finding_plural":     "résultat",
		"findings_plural":    "résultats",
		"findings_count":     "%s Résultats (%d)",
		"analyzer_label":     "Analyseur: %s",
		"attack_scenario":    "Scénario d'Attaque:",
		"remediation":        "Conseil de Remédiation:",
		"analyzer_breakdown": "Détail par Analyseur",
		"clean":              "propre",
		"recommendations":    "Recommandations",
		"rec_critical":       "NE PAS installer ce paquet sans examen manuel approfondi",
		"rec_moderate":       "Examinez tous les résultats HAUTS et CRITIQUES avant l'installation",
		"rec_scripts":        "Installer avec --ignore-scripts et inspecter les scripts manuellement",
		"rec_typosquat":      "Vérifiez le nom du paquet — cela ressemble à du typosquatting",
		"rec_vuln":           "Vérifiez si les vulnérabilités sont corrigées dans une version plus récente",
		"rec_provenance":     "Préférez les paquets avec provenance de build",
		"rec_deps":           "Auditez l'arbre complet des dépendances",
		"rec_maintainer":     "Vérifiez l'identité du mainteneur et les transferts récents de propriété",
		"rec_safe":           "Pas de préoccupations majeures — le paquet semble sûr",
		"audited_at":         "Audité à %s",
	},
	LangES: {
		"title":              "Informe de Auditoría de Seguridad npm",
		"pkg_info":           "Información del Paquete",
		"package":            "Paquete",
		"license":            "Licencia",
		"maintainers":        "Mantenedores",
		"repository":         "Repositorio",
		"created":            "Creado",
		"versions":           "Versiones",
		"published":          "publicado",
		"dependencies":       "Dependencias",
		"direct":             "directo",
		"install_scripts":    "Scripts de Instalación",
		"scripts_yes":        "SÍ — ejecuta código al instalar",
		"scripts_none":       "Ninguno",
		"risk_assessment":    "Evaluación de Riesgos",
		"critical_risk":      "RIESGO CRÍTICO",
		"moderate_risk":      "RIESGO MODERADO",
		"elevated_risk":      "RIESGO ELEVADO",
		"low_risk":           "RIESGO BAJO",
		"score_label":        "Puntuación: %d / 100",
		"analyzer_errors":    "Errores del Analizador",
		"no_issues":          "No se encontraron problemas. El paquete parece seguro.",
		"findings_summary":   "Resumen de Hallazgos",
		"total_findings":     "Total: %d hallazgos en %d analizadores",
		"severity_critical":  "CRÍTICO",
		"severity_high":      "ALTO",
		"severity_medium":    "MEDIO",
		"severity_low":       "BAJO",
		"finding_plural":     "hallazgo",
		"findings_plural":    "hallazgos",
		"findings_count":     "%s Hallazgos (%d)",
		"analyzer_label":     "Analizador: %s",
		"attack_scenario":    "Escenario de Ataque:",
		"remediation":        "Consejo de Remediación:",
		"analyzer_breakdown": "Desglose por Analizador",
		"clean":              "limpio",
		"recommendations":    "Recomendaciones",
		"rec_critical":       "NO instale este paquete sin una revisión manual exhaustiva",
		"rec_moderate":       "Revise todos los hallazgos ALTOS y CRÍTICOS antes de instalar",
		"rec_scripts":        "Instale con --ignore-scripts e inspeccione los scripts manualmente",
		"rec_typosquat":      "Verifique que tiene el nombre correcto — esto parece typosquatting",
		"rec_vuln":           "Compruebe si las vulnerabilidades se corrigen en una versión más reciente",
		"rec_provenance":     "Prefiera paquetes con procedencia de compilación",
		"rec_deps":           "Audite el árbol completo de dependencias",
		"rec_maintainer":     "Verifique la identidad del mantenedor y cambios recientes de propiedad",
		"rec_safe":           "Sin preocupaciones mayores — el paquete parece seguro",
		"audited_at":         "Auditado el %s",
	},
	LangIT: {
		"title":              "Rapporto di Audit di Sicurezza npm",
		"pkg_info":           "Informazioni sul Pacchetto",
		"package":            "Pacchetto",
		"license":            "Licenza",
		"maintainers":        "Manutentori",
		"repository":         "Repository",
		"created":            "Creato",
		"versions":           "Versioni",
		"published":          "pubblicato",
		"dependencies":       "Dipendenze",
		"direct":             "diretta",
		"install_scripts":    "Script di Installazione",
		"scripts_yes":        "SÌ — esegue codice all'installazione",
		"scripts_none":       "Nessuno",
		"risk_assessment":    "Valutazione del Rischio",
		"critical_risk":      "RISCHIO CRITICO",
		"moderate_risk":      "RISCHIO MODERATO",
		"elevated_risk":      "RISCHIO ELEVATO",
		"low_risk":           "RISCHIO BASSO",
		"score_label":        "Punteggio: %d / 100",
		"analyzer_errors":    "Errori dell'Analizzatore",
		"no_issues":          "Nessun problema trovato. Il pacchetto sembra sicuro.",
		"findings_summary":   "Riepilogo dei Risultati",
		"total_findings":     "Totale: %d risultati in %d analizzatori",
		"severity_critical":  "CRITICA",
		"severity_high":      "ALTA",
		"severity_medium":    "MEDIA",
		"severity_low":       "BASSA",
		"finding_plural":     "risultato",
		"findings_plural":    "risultati",
		"findings_count":     "%s Risultati (%d)",
		"analyzer_label":     "Analizzatore: %s",
		"attack_scenario":    "Scenario di Attacco:",
		"remediation":        "Consiglio di Rimedio:",
		"analyzer_breakdown": "Dettaglio per Analizzatore",
		"clean":              "pulito",
		"recommendations":    "Raccomandazioni",
		"rec_critical":       "NON installare questo pacchetto senza un'approfondita revisione manuale",
		"rec_moderate":       "Rivedere tutti i risultati ALTI e CRITICI prima dell'installazione",
		"rec_scripts":        "Installare con --ignore-scripts e ispezionare gli script manualmente",
		"rec_typosquat":      "Verificare il nome del pacchetto — sembra un typosquat",
		"rec_vuln":           "Controllare se le vulnerabilità sono risolte in una versione più recente",
		"rec_provenance":     "Preferire pacchetti con provenienza della build",
		"rec_deps":           "Controllare l'intero albero delle dipendenze",
		"rec_maintainer":     "Verificare l'identità del manutentore e recenti cambi di proprietà",
		"rec_safe":           "Nessuna preoccupazione maggiore — il pacchetto sembra sicuro",
		"audited_at":         "Audit eseguito il %s",
	},
	LangPT: {
		"title":              "Relatório de Auditoria de Segurança npm",
		"pkg_info":           "Informações do Pacote",
		"package":            "Pacote",
		"license":            "Licença",
		"maintainers":        "Mantenedores",
		"repository":         "Repositório",
		"created":            "Criado",
		"versions":           "Versões",
		"published":          "publicado",
		"dependencies":       "Dependências",
		"direct":             "direta",
		"install_scripts":    "Scripts de Instalação",
		"scripts_yes":        "SIM — executa código na instalação",
		"scripts_none":       "Nenhum",
		"risk_assessment":    "Avaliação de Risco",
		"critical_risk":      "RISCO CRÍTICO",
		"moderate_risk":      "RISCO MODERADO",
		"elevated_risk":      "RISCO ELEVADO",
		"low_risk":           "RISCO BAIXO",
		"score_label":        "Pontuação: %d / 100",
		"analyzer_errors":    "Erros do Analisador",
		"no_issues":          "Nenhum problema encontrado. O pacote parece seguro.",
		"findings_summary":   "Resumo das Descobertas",
		"total_findings":     "Total: %d descobertas em %d analisadores",
		"severity_critical":  "CRÍTICA",
		"severity_high":      "ALTA",
		"severity_medium":    "MÉDIA",
		"severity_low":       "BAIXA",
		"finding_plural":     "descoberta",
		"findings_plural":    "descobertas",
		"findings_count":     "%s Descobertas (%d)",
		"analyzer_label":     "Analisador: %s",
		"attack_scenario":    "Cenário de Ataque:",
		"remediation":        "Conselho de Correção:",
		"analyzer_breakdown": "Detalhe por Analisador",
		"clean":              "limpo",
		"recommendations":    "Recomendações",
		"rec_critical":       "NÃO instale este pacote sem uma revisão manual minuciosa",
		"rec_moderate":       "Revise todas as descobertas ALTAS e CRÍTICAS antes de instalar",
		"rec_scripts":        "Instale com --ignore-scripts e inspecione os scripts manualmente",
		"rec_typosquat":      "Verifique o nome do pacote — parece typosquatting",
		"rec_vuln":           "Verifique se as vulnerabilidades foram corrigidas em uma versão mais recente",
		"rec_provenance":     "Prefira pacotes com procedência de compilação",
		"rec_deps":           "Audite a árvore de dependências completa",
		"rec_maintainer":     "Verifique a identidade do mantenedor e mudanças recentes de propriedade",
		"rec_safe":           "Sem preocupações maiores — o pacote parece seguro",
		"audited_at":         "Auditado em %s",
	},
	LangJP: {
		"title":              "npm セキュリティ監査レポート",
		"pkg_info":           "パッケージ情報",
		"package":            "パッケージ",
		"license":            "ライセンス",
		"maintainers":        "メンテナー",
		"repository":         "リポジトリ",
		"created":            "作成日",
		"versions":           "バージョン数",
		"published":          "公開済み",
		"dependencies":       "依存関係",
		"direct":             "直接",
		"install_scripts":    "インストールスクリプト",
		"scripts_yes":        "あり — インストール時にコードを実行します",
		"scripts_none":       "なし",
		"risk_assessment":    "リスク評価",
		"critical_risk":      "重大なリスク",
		"moderate_risk":      "中程度のリスク",
		"elevated_risk":      "注意が必要なリスク",
		"low_risk":           "低いリスク",
		"score_label":        "スコア: %d / 100",
		"analyzer_errors":    "アナライザーエラー",
		"no_issues":          "問題は見つかりませんでした。パッケージは安全なようです。",
		"findings_summary":   "検出事項の概要",
		"total_findings":     "合計: %d 件の検出 (%d 個のアナライザー経由)",
		"severity_critical":  "致命的",
		"severity_high":      "高",
		"severity_medium":    "中",
		"severity_low":       "低",
		"finding_plural":     "件の検出",
		"findings_plural":    "件の検出",
		"findings_count":     "%s 検出事項 (%d)",
		"analyzer_label":     "アナライザー: %s",
		"attack_scenario":    "攻撃シナリオ:",
		"remediation":        "修正アドバイス:",
		"analyzer_breakdown": "アナライザー別の内訳",
		"clean":              "安全",
		"recommendations":    "推奨事項",
		"rec_critical":       "徹底的な手動確認なしに、このパッケージをインストールしないでください",
		"rec_moderate":       "インストール前に、すべての「高」および「致命的」な検出事項を確認してください",
		"rec_scripts":        "--ignore-scripts を付けてインストールし、スクリプトを手動で検査してください",
		"rec_typosquat":      "パッケージ名が正しいか確認してください。タイポスクワッティングの可能性があります",
		"rec_vuln":           "新しいバージョンで脆弱性が修正されているか確認してください",
		"rec_provenance":     "ビルドの証明（provenance）があるパッケージを優先してください",
		"rec_deps":           "依存関係ツリー全体を監査してください",
		"rec_maintainer":     "メンテナーの身元と、最近の所有権移転がないか確認してください",
		"rec_safe":           "大きな懸念はありません。パッケージは安全に使用できるようです",
		"audited_at":         "監査日時: %s",
	},
	LangZH: {
		"title":              "npm 安全审计报告",
		"pkg_info":           "包信息",
		"package":            "包名",
		"license":            "许可证",
		"maintainers":        "维护者",
		"repository":         "代码库",
		"created":            "创建于",
		"versions":           "版本",
		"published":          "已发布",
		"dependencies":       "依赖项",
		"direct":             "直接",
		"install_scripts":    "安装脚本",
		"scripts_yes":        "是 — 安装时运行代码",
		"scripts_none":       "无",
		"risk_assessment":    "风险评估",
		"critical_risk":      "严重风险",
		"moderate_risk":      "中度风险",
		"elevated_risk":      "潜在风险",
		"low_risk":           "低风险",
		"score_label":        "评分: %d / 100",
		"analyzer_errors":    "分析器错误",
		"no_issues":          "未发现问题。该包看起来是安全的。",
		"findings_summary":   "发现摘要",
		"total_findings":     "总计: 在 %d 个分析器中发现 %d 处问题",
		"severity_critical":  "紧急",
		"severity_high":      "高",
		"severity_medium":    "中",
		"severity_low":       "低",
		"finding_plural":     "处发现",
		"findings_plural":    "处发现",
		"findings_count":     "%s 发现 (%d)",
		"analyzer_label":     "分析器: %s",
		"attack_scenario":    "攻击场景:",
		"remediation":        "修复建议:",
		"analyzer_breakdown": "分析器详细统计",
		"clean":              "安全",
		"recommendations":    "建议",
		"rec_critical":       "在进行彻底的手动审查之前，请勿安装此包",
		"rec_moderate":       "在安装之前，请审查所有「高」和「紧急」级别的发现",
		"rec_scripts":        "使用 --ignore-scripts 进行安装并手动检查脚本",
		"rec_typosquat":      "请核对包名是否正确 — 这看起来像是拼写抢注 (typosquat)",
		"rec_vuln":           "检查漏洞是否在较新版本中得到修复",
		"rec_provenance":     "优先选择具有构建溯源 (provenance) 的包",
		"rec_deps":           "审计完整的依赖树",
		"rec_maintainer":     "验证维护者身份并检查近期是否有所有权转移",
		"rec_safe":           "无重大风险 — 该包可以安全使用",
		"audited_at":         "审计时间: %s",
	},
	LangRU: {
		"title":              "Отчет о проверке безопасности npm",
		"pkg_info":           "Информация о пакете",
		"package":            "Пакет",
		"license":            "Лицензия",
		"maintainers":        "Разработчики",
		"repository":         "Репозиторий",
		"created":            "Создан",
		"versions":           "Версии",
		"published":          "опубликовано",
		"dependencies":       "Зависимости",
		"direct":             "прямые",
		"install_scripts":    "Скрипты установки",
		"scripts_yes":        "ДА — запускает код при установке",
		"scripts_none":       "Нет",
		"risk_assessment":    "Оценка рисков",
		"critical_risk":      "КРИТИЧЕСКИЙ РИСК",
		"moderate_risk":      "УМЕРЕННЫЙ РИСК",
		"elevated_risk":      "ПОВЫШЕННЫЙ РИСК",
		"low_risk":           "НИЗКИЙ РИСК",
		"score_label":        "Баллы: %d / 100",
		"analyzer_errors":    "Ошибки анализаторов",
		"no_issues":          "Проблем не обнаружено. Пакет выглядит безопасным.",
		"findings_summary":   "Сводка результатов",
		"total_findings":     "Всего: %d результатов от %d анализаторов",
		"severity_critical":  "КРИТИЧЕСКАЯ",
		"severity_high":      "ВЫСОКАЯ",
		"severity_medium":    "СРЕДНЯЯ",
		"severity_low":       "НИЗКАЯ",
		"finding_plural":     "результат",
		"findings_plural":    "результатов",
		"findings_count":     "Результатов (%d): %s",
		"analyzer_label":     "Анализатор: %s",
		"attack_scenario":    "Сценарий атаки:",
		"remediation":        "Совет по устранению:",
		"analyzer_breakdown": "Разбивка по анализаторам",
		"clean":              "чисто",
		"recommendations":    "Рекомендации",
		"rec_critical":       "НЕ устанавливайте этот пакет без тщательной ручной проверки",
		"rec_moderate":       "Изучите все ВЫСОКИЕ и КРИТИЧЕСКИЕ результаты перед установкой",
		"rec_scripts":        "Устанавливайте с флагом --ignore-scripts и проверяйте скрипты вручную",
		"rec_typosquat":      "Проверьте правильность имени пакета — похоже на тайпосквоттинг",
		"rec_vuln":           "Проверьте, исправлены ли уязвимости в более новой версии",
		"rec_provenance":     "Предпочитайте пакеты с подтвержденным происхождением сборки",
		"rec_deps":           "Проверьте полное дерево зависимостей",
		"rec_maintainer":     "Проверьте личность разработчика и недавние смены владельца",
		"rec_safe":           "Серьезных проблем нет — пакет выглядит безопасным",
		"audited_at":         "Проверено %s",
	},
	LangTLH: { // Klingon
		"title":              "npm QaD Qu' 'oH",
		"pkg_info":           "ghom De'",
		"package":            "ghom",
		"license":            "chaw'",
		"maintainers":        "valwI'pu'",
		"repository":         "polmeH Duj",
		"created":            "chenmoHlu'pu'",
		"versions":           "mI'mey",
		"published":          "lablu'pu'",
		"dependencies":       "ghommey ghotpu'",
		"direct":             "ruv",
		"install_scripts":    "mI' lulermeb",
		"scripts_yes":        "HIja' — Qu' lulermeb",
		"scripts_none":       "pagh",
		"risk_assessment":    "Sura'meH Qu'",
		"critical_risk":      "Sura'qu' Qu'",
		"moderate_risk":      "Sura' Qu'",
		"elevated_risk":      "Sura'law' Qu'",
		"low_risk":           "Sura'be' Qu'",
		"score_label":        "mI': %d / 100",
		"analyzer_errors":    "Qu' lulermeb Qagh",
		"no_issues":          "Qagh pagh. ghom QaD.",
		"findings_summary":   "Befunde Summary (Klingon needs more study)",
		"total_findings":     "Hoch: %d findings across %d analyzers",
		"severity_critical":  "QID",
		"severity_high":      "HOCH",
		"severity_medium":    "MITTEL",
		"severity_low":       "NIEDRIG",
		"finding_plural":     "Befund",
		"findings_plural":    "Befunde",
		"findings_count":     "%s Befunde (%d)",
		"analyzer_label":     "Analysator: %s",
		"attack_scenario":    "ghob Scenario:",
		"remediation":        "qaD Advice:",
		"analyzer_breakdown": "Analysator breakdown",
		"clean":              "QaD",
		"recommendations":    "recs",
		"rec_critical":       "yIlo'Qo'!",
		"rec_moderate":       "yIghoH!",
		"rec_scripts":        "yIghoH scripts!",
		"rec_typosquat":      "yIghoH name!",
		"rec_vuln":           "yIghoH vulnerabilities!",
		"rec_provenance":     "yIghoH provenance!",
		"rec_deps":           "yIghoH dependencies!",
		"rec_maintainer":     "yIghoH maintainers!",
		"rec_safe":           "QaD",
		"audited_at":         "Audited at %s",
	},
	LangVUL: { // Vulcan
		"title":              "npm Security Audit Logic",
		"pkg_info":           "Package Data",
		"package":            "Unit",
		"license":            "Agreement",
		"maintainers":        "Stewards",
		"repository":         "Repository",
		"created":            "Initial Epoch",
		"versions":           "Iterations",
		"published":          "manifested",
		"dependencies":       "Integrations",
		"direct":             "primary",
		"install_scripts":    "Execution Scripts",
		"scripts_yes":        "Affirmative — logic executes on integration",
		"scripts_none":       "None",
		"risk_assessment":    "Probability Analysis",
		"critical_risk":      "ILLOGICAL RISK",
		"moderate_risk":      "SIGNIFICANT RISK",
		"elevated_risk":      "OBSERVABLE RISK",
		"low_risk":           "MINIMAL RISK",
		"score_label":        "Metric: %d / 100",
		"analyzer_errors":    "System Anomalies",
		"no_issues":          "No anomalies detected. Unit is logical.",
		"findings_summary":   "Data Summary",
		"total_findings":     "Total: %d observations across %d subsystems",
		"severity_critical":  "VITAL",
		"severity_high":      "HIGH",
		"severity_medium":    "MODERATE",
		"severity_low":       "NEGLIGIBLE",
		"finding_plural":     "observation",
		"findings_plural":    "observations",
		"findings_count":     "%s Observations (%d)",
		"analyzer_label":     "Subsystem: %s",
		"attack_scenario":    "Conflict Scenario:",
		"remediation":        "Corrective Action:",
		"analyzer_breakdown": "Subsystem Analysis",
		"clean":              "optimal",
		"recommendations":    "Logical Directives",
		"rec_critical":       "Integration is highly illogical and dangerous",
		"rec_moderate":       "Analyze vital and high observations before proceeding",
		"rec_scripts":        "Use --ignore-scripts to maintain system integrity",
		"rec_typosquat":      "Verify identity; name suggests deceptive intent",
		"rec_vuln":           "Assess newer iterations for vulnerability resolution",
		"rec_provenance":     "Prioritize units with verifiable origin",
		"rec_deps":           "Audit complete integration tree",
		"rec_maintainer":     "Verify steward credentials",
		"rec_safe":           "Integration is logical",
		"audited_at":         "Analyzed at %s",
	},
	LangSIN: { // Sindarin (Elvish)
		"title":              "Report on the Safety of npm",
		"pkg_info":           "Knowledge of the Package",
		"package":            "Package",
		"license":            "Charter",
		"maintainers":        "Guardians",
		"repository":         "Vault of Lore",
		"created":            "Awakened",
		"versions":           "Cycles",
		"published":          "revealed",
		"dependencies":       "Alliances",
		"direct":             "kin",
		"install_scripts":    "Rites of Integration",
		"scripts_yes":        "Yes — magic flows upon integration",
		"scripts_none":       "None",
		"risk_assessment":    "Omen Analysis",
		"critical_risk":      "DARK OMEN",
		"moderate_risk":      "TROUBLED OMEN",
		"elevated_risk":      "WARY OMEN",
		"low_risk":           "BRIGHT OMEN",
		"score_label":        "Measure: %d / 100",
		"analyzer_errors":    "Faded Visions",
		"no_issues":          "No darkness found. The path is clear.",
		"findings_summary":   "Summary of Omens",
		"total_findings":     "Total: %d omens across %d visions",
		"severity_critical":  "PERILOUS",
		"severity_high":      "SEVERE",
		"severity_medium":    "UNSETTLING",
		"severity_low":       "FIGHT",
		"finding_plural":     "omen",
		"findings_plural":    "omens",
		"findings_count":     "%s Omens (%d)",
		"analyzer_label":     "Vision: %s",
		"attack_scenario":    "Shadow Scenario:",
		"remediation":        "Healing Path:",
		"analyzer_breakdown": "Vision Breakdown",
		"clean":              "pure",
		"recommendations":    "Wise Counsel",
		"rec_critical":       "DO NOT bring this into your realm",
		"rec_moderate":       "Heed the perilous omens before integration",
		"rec_scripts":        "Integrate with care, ignoring the rites",
		"rec_typosquat":      "The name is a trick of the shadow",
		"rec_vuln":           "Seek a newer cycle where the flaw is healed",
		"rec_provenance":     "Prefer those with verifiable lineage",
		"rec_deps":           "Audit all alliances",
		"rec_maintainer":     "Verify the honor of the guardians",
		"rec_safe":           "The package is pure and safe to use",
		"audited_at":         "Envisioned at %s",
	},
}

func (r *Reporter) T(key string, args ...interface{}) string {
	lang := r.lang
	if lang == "" {
		lang = LangEN
	}

	m, ok := translations[lang]
	if !ok {
		m = translations[LangEN]
	}

	val, ok := m[key]
	if !ok {
		// Fallback to English
		val, ok = translations[LangEN][key]
		if !ok {
			return key
		}
	}

	if len(args) > 0 {
		return fmt.Sprintf(val, args...)
	}
	return val
}

func (r *Reporter) GetSeverityLabel(s analyzer.Severity) string {
	switch s {
	case analyzer.SeverityCritical:
		return r.T("severity_critical")
	case analyzer.SeverityHigh:
		return r.T("severity_high")
	case analyzer.SeverityMedium:
		return r.T("severity_medium")
	case analyzer.SeverityLow:
		return r.T("severity_low")
	default:
		return s.String()
	}
}

func (r *Reporter) GetRiskLevel(score int) (string, string) {
	if score >= 70 {
		return colorRed, r.T("critical_risk")
	}
	if score >= 40 {
		return colorYellow, r.T("moderate_risk")
	}
	if score >= 20 {
		return colorBlue, r.T("elevated_risk")
	}
	return colorGreen, r.T("low_risk")
}